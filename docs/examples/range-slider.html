<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Range Slider Example - UIstate Documentation</title>
  <link rel="stylesheet" href="main.css">
  <style>
    .demo-container {
      border: 1px solid #e0e0e0;
      padding: 20px;
      border-radius: 8px;
      margin: 20px 0;
      background-color: #f9f9f9;
    }
    
    .range-slider-container {
      margin-top: 20px;
      padding: 20px;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      background-color: #fff;
      width: 100%;
      max-width: 500px;
    }
    
    .range-label {
      display: block;
      margin-bottom: 15px;
      font-weight: 500;
      font-size: 16px;
    }
    
    .value-display {
      font-weight: 700;
      color: #3498db;
    }
    
    .range-track {
      position: relative;
      height: 6px;
      background-color: #e0e0e0;
      border-radius: 3px;
      cursor: pointer;
      margin: 10px 0;
    }
    
    .range-fill {
      position: absolute;
      height: 100%;
      background-color: #3498db;
      border-radius: 3px;
      pointer-events: none;
      width: var(--slider-position, 50%);
    }
    
    .range-thumb {
      position: absolute;
      width: 20px;
      height: 20px;
      background-color: #fff;
      border: 2px solid #3498db;
      border-radius: 50%;
      top: 50%;
      left: var(--slider-position, 50%);
      transform: translate(-50%, -50%);
      cursor: grab;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
    }
    
    .range-thumb:hover {
      background-color: #f5f5f5;
    }
    
    .range-thumb:active {
      cursor: grabbing;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    }

    /* Intensity level colors */
    .muted .range-fill { background-color: #95a5a6; }
    .muted .value-display { color: #95a5a6; }
    
    .low .range-fill { background-color: #3498db; }
    .low .value-display { color: #3498db; }
    
    .medium .range-fill { background-color: #2980b9; }
    .medium .value-display { color: #2980b9; }
    
    .high .range-fill { background-color: #e67e22; }
    .high .value-display { color: #e67e22; }
    
    .maximum .range-fill { background-color: #e74c3c; }
    .maximum .value-display { color: #e74c3c; font-weight: 700; }

    .code-example {
      background-color: #f8f9fa;
      border: 1px solid #e0e0e0;
      border-radius: 4px;
      padding: 15px;
      margin: 15px 0;
      overflow-x: auto;
    }
    
    .code-example pre {
      margin: 0;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1>Range Slider Example</h1>
      <p>Using numeric state values and derived state with UIstate</p>
    </div>
  </header>

  <div class="container">
    <nav class="breadcrumbs">
      <a href="../index.html">Home</a> &gt;
      <a href="../examples.html">Examples</a> &gt;
      <span>Range Slider</span>
    </nav>

    <main>
    <section class="intro">
      <h2>Introduction</h2>
      <p>
        This example demonstrates how to create a range slider component using UIstate principles.
        It builds on the concepts from the <a href="font-adjuster.html">Font Adjuster</a> example,
        but with a more sophisticated UI control that provides continuous input values.
      </p>
      <p>
        The range slider is a common UI element that allows users to select a value from a range
        by dragging a thumb along a track. This example shows how to:
      </p>
      <ul>
        <li>Use data attributes to store numeric state</li>
        <li>Create a custom slider control using HTML, CSS, and JavaScript</li>
        <li>Implement derived state based on value ranges</li>
        <li>Use CSS variables to position elements based on state</li>
      </ul>
    </section>

    <section class="demo">
      <h2>Live Demo</h2>
      <div class="demo-container">
        <div class="range-slider-container" id="demo-slider" data-uis-value="50" data-uis-min="0" data-uis-max="100">
          <label class="range-label">Volume: <span class="value-display">50</span></label>
          <div class="range-track">
            <div class="range-fill"></div>
            <div class="range-thumb"></div>
          </div>
        </div>
      </div>

      <script>
        // Demo implementation
        document.addEventListener('DOMContentLoaded', function() {
          // Get references to elements
          const container = document.querySelector('#demo-slider');
          const valueDisplay = container.querySelector('.value-display');
          const thumb = container.querySelector('.range-thumb');
          const track = container.querySelector('.range-track');
          
          // Initialize from data attributes
          updateSliderPosition();
          
          // Add event listeners for mouse/touch interactions
          thumb.addEventListener('mousedown', startDrag);
          track.addEventListener('click', jumpToPosition);
          
          // Function to start dragging the thumb
          function startDrag(e) {
            e.preventDefault();
            
            // Add event listeners for drag and release
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDrag);
            
            // Store initial position for drag calculation
            const initialX = e.clientX;
            const initialValue = parseInt(container.getAttribute('data-uis-value'));
            
            // Drag function
            function drag(e) {
              const trackRect = track.getBoundingClientRect();
              const min = parseInt(container.getAttribute('data-uis-min'));
              const max = parseInt(container.getAttribute('data-uis-max'));
              const trackWidth = trackRect.width;
              
              // Calculate new position based on drag distance
              const dragDistance = e.clientX - initialX;
              const dragRatio = dragDistance / trackWidth;
              const valueRange = max - min;
              const valueDelta = dragRatio * valueRange;
              
              // Calculate new value and constrain to min/max
              let newValue = Math.round(initialValue + valueDelta);
              newValue = Math.max(min, Math.min(max, newValue));
              
              // Update the data attribute (source of truth)
              container.setAttribute('data-uis-value', newValue);
              
              // Update the UI
              updateSliderPosition();
            }
            
            // Stop drag function
            function stopDrag() {
              document.removeEventListener('mousemove', drag);
              document.removeEventListener('mouseup', stopDrag);
            }
          }
          
          // Function to jump to clicked position
          function jumpToPosition(e) {
            const trackRect = track.getBoundingClientRect();
            const min = parseInt(container.getAttribute('data-uis-min'));
            const max = parseInt(container.getAttribute('data-uis-max'));
            const trackWidth = trackRect.width;
            
            // Calculate click position relative to track
            const clickX = e.clientX - trackRect.left;
            const clickRatio = clickX / trackWidth;
            
            // Calculate new value and constrain to min/max
            let newValue = Math.round(min + clickRatio * (max - min));
            newValue = Math.max(min, Math.min(max, newValue));
            
            // Update the data attribute (source of truth)
            container.setAttribute('data-uis-value', newValue);
            
            // Update the UI
            updateSliderPosition();
          }
          
          // Function to update slider position based on data attribute
          function updateSliderPosition() {
            const value = parseInt(container.getAttribute('data-uis-value'));
            const min = parseInt(container.getAttribute('data-uis-min'));
            const max = parseInt(container.getAttribute('data-uis-max'));
            
            // Calculate position percentage
            const percentage = ((value - min) / (max - min)) * 100;
            
            // Update CSS variable
            document.documentElement.style.setProperty('--slider-position', `${percentage}%`);
            
            // Update value display
            valueDisplay.textContent = value;
            
            // Update intensity class
            container.classList.remove('muted', 'low', 'medium', 'high', 'maximum');
            
            if (value <= 10) {
              container.classList.add('muted');
            } else if (value <= 30) {
              container.classList.add('low');
            } else if (value <= 70) {
              container.classList.add('medium');
            } else if (value <= 85) {
              container.classList.add('high');
            } else {
              container.classList.add('maximum');
            }
          }
        });
      </script>
    </section>

    <section class="implementation">
      <h2>Implementation Walkthrough</h2>
      
      <h3>HTML Structure</h3>
      <p>
        The range slider consists of a container with data attributes for state,
        a label with value display, and the slider components (track, fill, and thumb).
      </p>
      <div class="code-example">
        <pre><code>&lt;div class="range-slider-container" data-uis-value="50" data-uis-min="0" data-uis-max="100"&gt;
  &lt;label class="range-label"&gt;Volume: &lt;span class="value-display"&gt;50&lt;/span&gt;&lt;/label&gt;
  &lt;div class="range-track"&gt;
    &lt;div class="range-fill"&gt;&lt;/div&gt;
    &lt;div class="range-thumb"&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
      </div>
      
      <h3>State Management</h3>
      <p>
        The state is stored in data attributes on the container element:
      </p>
      <ul>
        <li><code>data-uis-value</code>: The current value of the slider</li>
        <li><code>data-uis-min</code>: The minimum allowed value</li>
        <li><code>data-uis-max</code>: The maximum allowed value</li>
      </ul>
      <p>
        When the user interacts with the slider, JavaScript updates these attributes,
        which serve as the source of truth for the component's state.
      </p>
      
      <h3>CSS Variables for Position</h3>
      <p>
        The position of the thumb and fill elements is controlled by a CSS variable:
      </p>
      <div class="code-example">
        <pre><code>:root {
  --slider-position: 50%;
}

.range-fill {
  width: var(--slider-position);
}

.range-thumb {
  left: var(--slider-position);
}</code></pre>
      </div>
      <p>
        When the state changes, JavaScript calculates the appropriate percentage and
        updates the <code>--slider-position</code> CSS variable.
      </p>
      
      <h3>Derived State</h3>
      <p>
        Based on the current value, we derive an "intensity level" that affects the
        appearance of the slider. This is similar to the text size categories in the
        Font Adjuster example, but with more granular ranges:
      </p>
      <div class="code-example">
        <pre><code>/* In state.css */
.range-slider-container[data-uis-value="0"],
.range-slider-container[data-uis-value="1"],
/* ... more values ... */
.range-slider-container[data-uis-value="10"] {
  --intensity-level: "muted";
}

/* More ranges for other intensity levels... */

/* Apply styles based on intensity level */
.range-slider-container[style*="--intensity-level: \"muted\""] .range-fill {
  background-color: #95a5a6;
}

/* More styles for other intensity levels... */</code></pre>
      </div>
      
      <h3>JavaScript Interaction</h3>
      <p>
        The JavaScript handles three main interactions:
      </p>
      <ol>
        <li>Dragging the thumb</li>
        <li>Clicking on the track to jump to a position</li>
        <li>Updating the UI based on the current state</li>
      </ol>
      <p>
        The key principle is that all UI updates flow from the state (data attributes),
        maintaining the declarative approach of UIstate.
      </p>
    </section>

    <section class="key-insights">
      <h2>Key Insights</h2>
      
      <h3>Continuous vs. Discrete State</h3>
      <p>
        Unlike toggle buttons that have discrete states (on/off), the range slider
        represents a continuous range of values. This demonstrates how UIstate can
        handle both discrete and continuous state values.
      </p>
      
      <h3>Derived Categories from Continuous Values</h3>
      <p>
        The intensity levels (muted, low, medium, high, maximum) are derived from
        ranges of the continuous value. This shows how continuous numeric state can
        be mapped to discrete categorical state for styling purposes.
      </p>
      
      <h3>CSS Variables as Computational Layer</h3>
      <p>
        The <code>--slider-position</code> CSS variable serves as a computational
        layer between the raw state (numeric value) and the visual representation
        (position of elements). This demonstrates how CSS variables can transform
        state data into visual properties.
      </p>
      
      <h3>Progressive Enhancement</h3>
      <p>
        The slider works at multiple levels:
      </p>
      <ol>
        <li>At the HTML level, it provides the current value as a data attribute</li>
        <li>At the CSS level, it positions elements and applies styles based on state</li>
        <li>At the JavaScript level, it enables interactive manipulation of the state</li>
      </ol>
      <p>
        This layered approach aligns with UIstate's philosophy of progressive enhancement.
      </p>
    </section>

    <section class="next-steps">
      <h2>Taking It Further</h2>
      <p>This example demonstrates a basic range slider. You could extend it by:</p>
      <ul>
        <li>Adding tick marks and labels for specific values</li>
        <li>Creating a double-ended range slider for selecting a range</li>
        <li>Adding keyboard accessibility for better usability</li>
        <li>Integrating it with other components, such as the Font Adjuster</li>
      </ul>
    </section>
    </main>
  </div>

  <footer>
    <div class="container">
      <p>&copy; 2025 UIstate - A declarative state management approach for the web</p>
    </div>
  </footer>
</body>
</html>
